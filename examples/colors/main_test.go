package main

import (
	"strings"
	"testing"
)

func TestGCMC(t *testing.T) {
	g := gcmc()
	got := strings.Split(g.String(), "\n")
	want := strings.Split(gcmcOut, "\n")

	if len(got) != len(want) {
		t.Errorf("gcmc = %v lines, want %v", len(got), len(want))
	}

	for i, line := range got {
		if i == 1 {
			continue
		}
		if i < len(want) && line != want[i] {
			t.Fatalf("gcmc line #%v:\n%v\nwant:\n%v", i+1, line, want[i])
		}
	}
}

var gcmcOut = `(go-gcode compiled code, do not change)
(2021-09-17 12:08:02)
(-- prologue begin --)
G17 ( Use XY plane )
G21 ( Use mm )
G40 ( Cancel cutter radius compensation )
G49 ( Cancel tool length compensation )
G54 ( Default coordinate system )
G80 ( Cancel canned cycle )
G90 ( Use absolute distance mode )
G94 ( Units Per Minute feed rate mode )
G64 ( Enable path blending for best speed )
(-- prologue end --)
G0 X10.00000000 Y-10.00000000
G1 X-10.00000000
G1 Y10.00000000
G1 X10.00000000
G1 Y-10.00000000
G0 X50.00000000 Y-50.00000000
G1 X-50.00000000
G1 Y50.00000000
G1 X50.00000000
G1 Y-50.00000000
G0 X52.54827455 Y-47.31467893
G1 X-47.31467893 Y-52.54827455
G1 X-52.54827455 Y47.31467893
G1 X47.31467893 Y52.54827455
G1 X52.54827455 Y-47.31467893
G0 X54.95251793 Y-44.49967161
G1 X-44.49967161 Y-54.95251793
G1 X-54.95251793 Y44.49967161
G1 X44.49967161 Y54.95251793
G1 X54.95251793 Y-44.49967161
G0 X57.20614028 Y-41.56269378
G1 X-41.56269378 Y-57.20614028
G1 X-57.20614028 Y41.56269378
G1 X41.56269378 Y57.20614028
G1 X57.20614028 Y-41.56269378
G0 X59.30296458 Y-38.51179550
G1 X-38.51179550 Y-59.30296458
G1 X-59.30296458 Y38.51179550
G1 X38.51179550 Y59.30296458
G1 X59.30296458 Y-38.51179550
G0 X61.23724357 Y-35.35533906
G1 X-35.35533906 Y-61.23724357
G1 X-61.23724357 Y35.35533906
G1 X35.35533906 Y61.23724357
G1 X61.23724357 Y-35.35533906
G0 X63.00367553 Y-32.10197610
G1 X-32.10197610 Y-63.00367553
G1 X-63.00367553 Y32.10197610
G1 X32.10197610 Y63.00367553
G1 X63.00367553 Y-32.10197610
G0 X64.59741880 Y-28.76062385
G1 X-28.76062385 Y-64.59741880
G1 X-64.59741880 Y28.76062385
G1 X28.76062385 Y64.59741880
G1 X64.59741880 Y-28.76062385
G0 X66.01410504 Y-25.34044073
G1 X-25.34044073 Y-66.01410504
G1 X-66.01410504 Y25.34044073
G1 X25.34044073 Y66.01410504
G1 X66.01410504 Y-25.34044073
G0 X67.24985120 Y-21.85080122
G1 X-21.85080122 Y-67.24985120
G1 X-67.24985120 Y21.85080122
G1 X21.85080122 Y67.24985120
G1 X67.24985120 Y-21.85080122
G0 X68.30127019 Y-18.30127019
G1 X-18.30127019 Y-68.30127019
G1 X-68.30127019 Y18.30127019
G1 X18.30127019 Y68.30127019
G1 X68.30127019 Y-18.30127019
G0 X69.16548015 Y-14.70157665
G1 X-14.70157665 Y-69.16548015
G1 X-69.16548015 Y14.70157665
G1 X14.70157665 Y69.16548015
G1 X69.16548015 Y-14.70157665
G0 X69.84011233 Y-11.06158710
G1 X-11.06158710 Y-69.84011233
G1 X-69.84011233 Y11.06158710
G1 X11.06158710 Y69.84011233
G1 X69.84011233 Y-11.06158710
G0 X70.32331763 Y-7.39127852
G1 X-7.39127852 Y-70.32331763
G1 X-70.32331763 Y7.39127852
G1 X7.39127852 Y70.32331763
G1 X70.32331763 Y-7.39127852
G0 X70.61377159 Y-3.70071096
G1 X-3.70071096 Y-70.61377159
G1 X-70.61377159 Y3.70071096
G1 X3.70071096 Y70.61377159
G1 X70.61377159 Y-3.70071096
G0 X70.71067812 Y-0.00000000
G1 X-0.00000000 Y-70.71067812
G1 X-70.71067812 Y0.00000000
G1 X0.00000000 Y70.71067812
G1 X70.71067812 Y-0.00000000
G0 X70.61377159 Y3.70071096
G1 X3.70071096 Y-70.61377159
G1 X-70.61377159 Y-3.70071096
G1 X-3.70071096 Y70.61377159
G1 X70.61377159 Y3.70071096
G0 X70.32331763 Y7.39127852
G1 X7.39127852 Y-70.32331763
G1 X-70.32331763 Y-7.39127852
G1 X-7.39127852 Y70.32331763
G1 X70.32331763 Y7.39127852
G0 X69.84011233 Y11.06158710
G1 X11.06158710 Y-69.84011233
G1 X-69.84011233 Y-11.06158710
G1 X-11.06158710 Y69.84011233
G1 X69.84011233 Y11.06158710
G0 X69.16548015 Y14.70157665
G1 X14.70157665 Y-69.16548015
G1 X-69.16548015 Y-14.70157665
G1 X-14.70157665 Y69.16548015
G1 X69.16548015 Y14.70157665
G0 X68.30127019 Y18.30127019
G1 X18.30127019 Y-68.30127019
G1 X-68.30127019 Y-18.30127019
G1 X-18.30127019 Y68.30127019
G1 X68.30127019 Y18.30127019
G0 X67.24985120 Y21.85080122
G1 X21.85080122 Y-67.24985120
G1 X-67.24985120 Y-21.85080122
G1 X-21.85080122 Y67.24985120
G1 X67.24985120 Y21.85080122
G0 X66.01410504 Y25.34044073
G1 X25.34044073 Y-66.01410504
G1 X-66.01410504 Y-25.34044073
G1 X-25.34044073 Y66.01410504
G1 X66.01410504 Y25.34044073
G0 X64.59741880 Y28.76062385
G1 X28.76062385 Y-64.59741880
G1 X-64.59741880 Y-28.76062385
G1 X-28.76062385 Y64.59741880
G1 X64.59741880 Y28.76062385
G0 X63.00367553 Y32.10197610
G1 X32.10197610 Y-63.00367553
G1 X-63.00367553 Y-32.10197610
G1 X-32.10197610 Y63.00367553
G1 X63.00367553 Y32.10197610
G0 X61.23724357 Y35.35533906
G1 X35.35533906 Y-61.23724357
G1 X-61.23724357 Y-35.35533906
G1 X-35.35533906 Y61.23724357
G1 X61.23724357 Y35.35533906
G0 X59.30296458 Y38.51179550
G1 X38.51179550 Y-59.30296458
G1 X-59.30296458 Y-38.51179550
G1 X-38.51179550 Y59.30296458
G1 X59.30296458 Y38.51179550
G0 X57.20614028 Y41.56269378
G1 X41.56269378 Y-57.20614028
G1 X-57.20614028 Y-41.56269378
G1 X-41.56269378 Y57.20614028
G1 X57.20614028 Y41.56269378
G0 X54.95251793 Y44.49967161
G1 X44.49967161 Y-54.95251793
G1 X-54.95251793 Y-44.49967161
G1 X-44.49967161 Y54.95251793
G1 X54.95251793 Y44.49967161
G0 X52.54827455 Y47.31467893
G1 X47.31467893 Y-52.54827455
G1 X-52.54827455 Y-47.31467893
G1 X-47.31467893 Y52.54827455
G1 X52.54827455 Y47.31467893
G0 X20.00000000 Y-20.00000000
G1 X-20.00000000
G1 Y20.00000000
G1 X20.00000000
G1 Y-20.00000000
G0 X25.00000000 Y-25.00000000
G1 X-25.00000000
G1 Y25.00000000
G1 X25.00000000
G1 Y-25.00000000
G0 X-7.50000000 Y-12.50000000
G1 X-12.50000000
G1 Y-7.50000000
G1 X-7.50000000
G1 Y-12.50000000
G0 Y7.50000000
G1 X-12.50000000
G1 Y12.50000000
G1 X-7.50000000
G1 Y7.50000000
G0 X12.50000000
G1 X7.50000000
G1 Y12.50000000
G1 X12.50000000
G1 Y7.50000000
G0 Y-12.50000000
G1 X7.50000000
G1 Y-7.50000000
G1 X12.50000000
G1 Y-12.50000000
(-- epilogue begin --)
M30 (-- epilogue end --)
`
